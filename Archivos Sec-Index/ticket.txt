ACCION StockYTicket() ES
AMBIENTE

	RF = REGISTRO
		DD:
		MM:
		AA:
	FINREGISTRO

	RPROD = REGISTRO
		COD_PROD:
		NOM:
		STOCK:
		PRECIO:
	FINREGISTRO

	PRODUCTOS: ARCHIVO DE RPROD INDEXADO POR COD_PROD
	PROD: RPROD

	RDETALLE = REGISTRO
		NROTICKET:
		NROLINEA:
		COD_PROD:
		CANT:
	FINREGISTRO

	DETALLE_TICKET: ARCHVIO DE RDETALLE INDEXADO POR NROTICKET
	DETA: RDETALLE

	RTICKET = REGISTRO
		NROTICKET:
		FECHA: RF
		CLIENTE:
	FINREGISTRO

	TICKET: ARCHIVO DE RTICKET INDEXADO POR NROTICKET
	TICK: RTICKET

	EMPRESA: AN(20)
	CUIT: N(11)
	HOY:RF
	BAND: BOOLEANO
	CANT: N(6)
	OP: AN(1)
	TOT: N(8)

PROCESO
	BAND:= VERDADERO
	ABRIR E/S (DETALLE_TICKET)
	ABRIR E/S (TICKET)
	ABRIR E/S (PRODUCTOS)

	ESC("INGRESE EMPRESA: ");LEER(EMPRESA)
	ESC("INGRESE CUIT: "); LEER(CUIT)
	ESC("INGRESE FECHA DE HOY: "); LEER (HOY)

	MIENTRAS (BAND = VERDADERO) HACER
		ESC("INGRESE CODIGO DE PRODUCTO");LEER(PROD.COD_PROD)
		LEER(PRODUCTO,PROD)

		SI EXISTE ENTONCES
			
			ESC("CANTIDAD: ");LEER(CANT)
			PROD.CANT:= PROD.CANT - CANT
			REGRABAR(PRODUCTO,PROD)
		
			DETA.NROTICKET:= OBTENER_TICKET()
			DETA.COD_PROD:= PROD.COD_PROD
			DETA.CANT:= CANT
			GRABAR(DETALLE_TICKET,DETA)
		
			TICK.NROTICKET:= OBTENER_TICKET()
			TICK.FECHA:= HOY
			TICK.CLIENTE:= "CONSUMIDOR FINAL"
			GRABAR(TICKET,TICK)
		
			TOT:= TOT + PROD.PRECIO
		
		SINO
			
			ESC("EL PRODUCTO NO EXISTE")
		
		FINSI
	
		ESC("DESEA AGREGAR MAS PRODUCTOS?");LEER(OP)
		
		SI OP = "N" ENTONCES
			BAND:= FALSO
		FINSI
	
	FINMIENTRAS
	
FINACCION