ACCION RECUR3ERPAR(PRIM: PUNTERO A NODO) ES
AMBIENTE

	NODO: REGISTRO
		DATO: N(7)
		PROX: PUNTERO A NODO
	FINREGISTRO

	PRIM,P: PUNTERO A NODO
	PRIMS,PS: PUNTERO A NODO

	FUNCION DETECCION (N:N(7)):BOOLEANO ES
		SI (N=1) ENTONCES
			DETECCION:= TRUE
		SINO
			DETECCION:= DETECCION(N MOD 100) AND NOT(DETECCION(N DIV 100)) OR DETECCION(N DIV 100) AND NOT(DETECCION(N MOD 100))
		FINSI
	FINFUNCION

PROCESO
	PRIMS:=NULL
	SI PRIM = NULL ENTONCES
		ESC("LA LISTA DE ENTRADA ESTA VACIA")	
	SINO
		P:= PRIM
		MIENTRAS (*P.PROX <> NULL) ENTONCES
			SI (DETECCION (*P.DATO) = FALSE) ENTONCES
				NUEVO (PS)
				PS:=P
				SI PRIMS=NULL ENTONCES
					PRIMS:=PS
					*PS.PROX:=NULL
				SINO
					*PS.PROX:=PRIMS
					PRIMS:= PS
				FINSI
			FINSI
		P:=*P.PROX
		FINMIENTRAS
	FINSI

FINACCION