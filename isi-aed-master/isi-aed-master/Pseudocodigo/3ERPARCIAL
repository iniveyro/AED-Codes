ACCION 3ERPARCIAL (PRIM: PUNTERO A NODO) ES
AMBIENTE
	REGARCH: REGISTRO
		CODIGO: N(10)
		NOMBRE: AN(60)
		TIPO: CARACTER
		CANT_ERRORES: N(3)
	FINREGISTRO

	NODO: REGISTRO
		DESCRIPCION: AN(250)
		ESTADO: CARACTER
		PROX: PUTERO A NODO
	FINREGISTRO

	NODOSALIDA: REGISTRO
		ANT: PUNTERO A NODOSALIDA
		CODIGO: N(10)
		NOMBRE: AN(60)
		PORC: N(3)
		PROX: PUNTERO A NODOSALIDA
	FINREGISTRO

	PRIM,P: PUNTERO A NODO
	PRIMS1,P1,ULT1: PUNTERO A NODO
	PRIMS2,P2,Q2,ULT2: PUNTERO A NODO

	I,CONT,CONT2,NORES:ENTERO

	ARCH: ARCHIVO DE REGARCH ORDENADO POR CODIGO
	REG:REGARCH

	PROCEDIMIENTO LISTAUNO() HACER
		NUEVO(P1)
		*P1.CODIGO:= REG.CODIGO
		*P1.NOMBRE:= REG.NOMBRE
		*P1.PORC:= REG.PORC
		
		SI PRIMS1 = NULL ENTONCES
			PRIMS1:=P1
			ULT1:=P1
			*P1.ANT:= NULL
			*P1.PROX:= NULL
		SINO
			*P1.PROX:= PRIM
			*(P1.PROX).ANT:= P1
			*P1.ANT:= NULL
			PRIM:=P1
		FINSI
	FINPROCEDIMIENTO

	PROCEDIMIENTO LISTADOS(X:ENTERO) HACER
		NUEVO(P2)
		Q2:=PRIMS2
		*P2.CODIGO:= REG.CODIGO
		*P2.NOMBRE:= REG.NOMBRE
		*P2.PORC:= REG.PORC
		
		SI PRIMS2 = NULL ENTONCES
			PRIMS2:=P2
			ULT2:=P2
			*P1.ANT:= NULL
			*P1.PROX:= NULL
		SINO
			SI (*P2.PORC >= 50) ENTONCES
		
				MIENTRAS (*P2.PORC > *Q2.PORC) Y (Q2 <> ULT) HACER
					Q2:=*Q2.PROX
				FINMIENTRAS

				SI (Q2=PRIMS2) ENTONCES
					*P2.ANT:=NULL
					*Q2.ANT:=P2
					*P.PROX:= Q2
					PRIMS2:=P2
				SINO
		
					SI (Q2 = ULT2) ENTONCES
						*P2.PROX:=NULL
						*P2.ANT:=ULT
						*Q2.PROX:=P2
						ULT:=P2
					SINO
						*(Q2.ANT).PROX:=P2
						*P2.ANT:=*Q2.ANT
						*P2.PROX:=Q2
						*Q2.ANT:=P2
					FINSI
				FINSI
		
			FINSI
		
		FINSI
	
	FINPROCEDIMIENTO


PROCESO

	ABRIR E/(ARCH)
	LEER(ARCH, REG)
	P:=PRIM

	MIENTRAS NFDA (ARCH) HACER
		CONT,NORES,CONT2:=0

		PARA  I:= 1 HASTA REG.CANT_ERRORES HACER
			SI (*P.ESTADO = "R") ENTONCES
				CONT:= CONT+1
			SINO
				SI (*P.ESTADO = "N") ENTONCES
					CONT2:= CONT2 + 1
				FINSI
			FINSI
			P:=*P.PROX
		FINPARA
		
		SI REG.CANT_ERRORES = CONT ENTONCES
			LISTAUNO()
		SINO
			SI ((CONT DIV REG.CANT_ERRORES)DIV 100 >= 50) ENTONCES
				LISTADOS(CONT)
			SINO
				SI (CONT2 = REG.CANT_ERRORES) ENTONCES
					NORES:= NORES + 1 
				FINSI
			FINSI
		FINSI

		P:=*P.PROX
		LEER(ARCH, REG)
	
	FINMIENTRAS

	CERRAR (ARCH)
	ESC("HUBIERON UN TOTAL DE: ", NORES, "PROYECTOS CON TODOS SUS ERRORES SIN RESOLVER")
FINACCION