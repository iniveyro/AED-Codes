ACCION ARREGLORECUPAR2 () ES
AMBIENTE

	REG2: REGISTRO
		NU_VEND: N(5)
		REGION:N(2)
		PUNT: N(1,1)
		OP: N(1,1)
		TIPO_MERLIBRE: AN(1)
	FINREGISTRO11

	ARCHVENDEDORES: ARCHIVO DE REG2 INDEXADO POR NU_VENDEDOR

	REG_VEN:REG2

	ARR: ARREGLO [1...6,1...4] DE ENTEROS
	I,J: ENTERO

	FUNCION TIPO (X: AN(1)):ENTERO ES

		SEGUN X HACER
			"S": TIPOMERCADOLIBRE:= 1
			"P": TIPOMERCADOLIBRE:= 2
			"G": TIPOMERCADOLIBRE:= 3
		FINSEGUN

	FINFUNCION

	CANT: N(2)
	MAX,POSI,POSJ: ENTERO

PROCESO
	
	I,J,POSI,POSJ,CONT:=0

	ABRIR E/ (ARCHVENDEDORES)
	LEER(REG_VEN,ARCHVENDEDORES)
	MAX:=1

	MIENTRAS NFDA (ARCHVENDEDORES) HACER
		
		ARR[REG_VEN.REGION,TIPO(REG_VEN.TIPO_MERLIBRE)]:= ARR[REG_VEN.REGION,TIPOMERCADOLIBRE(REG_VEN.TIPO_MERLIBRE)] + REG_VEN.PUNT
		
		CANT:= CANT + 1

		LEER(REG_VEN,ARCHVENDEDORES)
	FINMIENTRAS

	ARR[6,4]:= ARR[6,4] DIV CANT

	PARA I:= 1 HASTA 5 HACER
		PARA J:=1 HASTA 3 HACER
			ARR[I,J]:=ARR[I,J] DIV CANT
			ARR[6,J]:= ARR[6,J] DIV CANT
			ESC ("LA REGION N°: ",I,"Y TIPO DE VENDEDOR N°: ", J, "EL PROMEDIO ES DE: " ARR[I,J])
			SI ARR[I,J] > MAX ENTONCES
				MAX:= ARR[I,J]
				POSI:= I
				POSJ:= J
			FINSI
		FINPARA
		ARR[I,4]:= ARR[I,4] DIV CANT
		ESC ("PARA LA REGION N°: ",I,"EL PROMEDIO DE PUNTUACION ES: ", ARR[I,4])
	FINPARA

	ESC("LA REGION CON MAS PUNTUACION PROMEDIO TIENE ES: ", POSI, "DEL TIPO DE MERCADOLIDER ES: ",POSJ)
	CERRAR(ARCHVENDEDORES)
FINACCION